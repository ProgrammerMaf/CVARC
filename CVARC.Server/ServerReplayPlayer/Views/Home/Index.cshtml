@model CommonTypes.CompetitionsInfo[]

@{
    Layout = null;
}

<!DOCTYPE html>

<html>
    <head>
        <title>Replayer</title>
        <link type="text/css" rel="stylesheet" href="/other/css.css" />
        <script lang="text/javascript" src="/Scripts/jquery-1.7.2.min.js"></script>
        <script lang="text/javascript" src="/Scripts/jquery.uploadfile.min.js"></script>
        <script lang="text/javascript">
            $(document).ready(function() {
                $("[uploadClient]").each(function (i, element) {
                    var jElement = $(element);
                    var level = jElement.attr("uploadClient");
                    jElement.uploadFile({
                        url: "/Replay/UploadFile?level=" + level,
                        fileName: "file",
                        acceptFiles: ".zip, .rar",
                        dragDrop: false,
                        onSuccess: function () {
                            alert('загружено!');
                        },
                        onError: function () {
                            window.location = "/Replay/UploadFailed";
                        }
                    });
                });
            });
        </script>
    </head>
    <body>
        <table id="mainTable" align="center">
            <tr>
                @foreach (var replay in Model)
                {
                    <td>
                        <h2>@replay.Level</h2>
                        <div uploadClient="@replay.Level">Загрузить решение</div>
                    </td>
                }
            </tr>
            <tr>
                @foreach (var replays in Model)
                {
                    <td>
                        <table align="center" class="info">
                            <thead>
                                <tr>
                                    <td>Имя</td>
                                    <td>Очки</td>
                                </tr>
                            </thead>
                            @foreach (var replay in replays.MatchResults)
                            {
                                <tr>
                                    @{ var text = replay.Player.Name + (replay.Player2 == null ? "" : " vs " + replay.Player2.Name); }
                                    <td>
                                        @if (replay.Id != null)
                                        {
                                            var url = "/Replay/Get?level=" + replays.Level + "&id=" + replay.Id;
                                            <a href="@url" class="linkName">@text</a>
                                        }
                                        else
                                        {
                                            <div>@text</div>
                                        }
                                    </td>
                                    <td>
                                        @(string.IsNullOrEmpty(replay.Points) ? "Матч ещё не сыгран" : replay.Points)
                                    </td>
                                </tr>
                            }
                        </table>
                    </td>
                }
        </table>
    </body>
</html>